<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ExisMirror 存在镜像 | 潜意识投射与哲学坐标</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        body { font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", serif; background-color: #050505; color: #e5e5e5; }
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { display: none; }
        .bg-grid { background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px); background-size: 20px 20px; }
        .scan-line { width: 100%; height: 2px; background: linear-gradient(to right, transparent, rgba(197, 160, 89, 0.8), transparent); animation: scan 2s infinite linear; }
        @keyframes scan { 0% { transform: translateY(-50px); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(150px); opacity: 0; } }
        .blur-result { filter: blur(10px) brightness(0.3); pointer-events: none; user-select: none; }
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="w-full max-w-md bg-[#0a0a0a] rounded-sm border border-gray-800 shadow-2xl overflow-hidden relative min-h-[750px] flex flex-col">
        
        <div id="view-home" class="flex-1 flex flex-col items-center justify-center p-8 fade-in text-center relative bg-grid">
            <div class="mb-10 flex flex-col items-center">
                <div class="text-[#c5a059] text-3xl font-light tracking-widest mb-2 font-serif">E | M</div>
                <div class="text-gray-600 text-[10px] tracking-[0.4em] uppercase">ExisMirror Lab</div>
            </div>
            <h1 class="text-2xl font-serif text-gray-100 mb-6 tracking-widest leading-loose">你的灵魂底色，<br>由哪位哲学家书写？</h1>
            <p class="text-gray-500 mb-16 text-xs leading-loose font-light tracking-widest">
                20个潜意识视觉投射实验<br>16型哲学家人格映射档案<br>用思想的锋刃，解构真实的自我
            </p>
            <button onclick="startQuiz()" class="w-full bg-[#111] border border-[#c5a059] text-[#c5a059] font-medium py-4 rounded-sm tracking-widest hover:bg-[#c5a059] hover:text-black transition-all active:scale-95 text-sm">
                开启镜像
            </button>
            
        </div>

        <div id="view-quiz" class="flex-1 flex flex-col p-6 hidden bg-grid">
            <div class="flex justify-between items-center mb-8 text-xs text-gray-500 tracking-widest font-mono">
                <span>[ 潜意识观测进行中 ]</span>
                <span id="progress-text">1/20</span>
            </div>
            <div id="question-container" class="flex-1 fade-in flex flex-col">
                <h2 id="question-title" class="text-[17px] font-medium text-gray-200 mb-8 leading-loose tracking-wide text-justify"></h2>
                <div id="options-container" class="space-y-4 pb-4"></div>
            </div>
        </div>

        <div id="view-loading" class="flex-1 flex flex-col items-center justify-center p-8 hidden relative overflow-hidden bg-grid">
            <div class="absolute inset-0 flex items-center justify-center opacity-10">
                <div class="text-9xl text-[#c5a059] font-serif font-bold tracking-tighter">E|M</div>
            </div>
            <div class="scan-line absolute top-1/4 left-0"></div>
            <div class="z-10 text-center fade-in">
                <div class="w-12 h-12 border-t-2 border-[#c5a059] border-solid rounded-full animate-spin mx-auto mb-6"></div>
                <h3 class="text-lg text-white font-medium tracking-widest mb-2 font-serif">正在解构潜意识迷宫</h3>
                <p class="text-[#c5a059] text-xs tracking-wider font-mono" id="loading-text">比对哲学原初坐标中...</p>
            </div>
        </div>

        <div id="view-paywall" class="flex-1 flex flex-col p-0 hidden relative bg-[#0a0a0a]">
            <div class="absolute inset-0 p-6 blur-result flex flex-col items-center opacity-40 bg-grid">
                <div class="text-[#c5a059] text-xs tracking-[0.4em] mt-10">AESTHETIC ARCHETYPE</div>
                <div class="text-5xl text-white font-serif mt-6">XXXX</div>
                <div class="w-[200px] h-[200px] rounded-full bg-gray-800 mt-10"></div>
                <div class="w-full h-24 bg-gray-900 mt-8 rounded-sm"></div>
            </div>
            
            <div class="absolute inset-0 flex flex-col items-center justify-center p-8 z-10 bg-gradient-to-t from-[#050505] via-[#050505]/95 to-[#050505]/80">
                <div class="w-12 h-12 bg-[#0a0a0a] rounded-full flex items-center justify-center mb-6 border border-[#c5a059]">
                    <svg class="w-5 h-5 text-[#c5a059]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                </div>
                <h2 class="text-xl font-serif text-white mb-2 tracking-widest">专属哲学档案已封存</h2>
                <p class="text-gray-400 text-xs mb-8 text-center leading-relaxed tracking-widest">请前往 ExisMirror 官方获取解码权限<br></p>
                
                <div class="w-full mb-4">
                    <input type="number" id="unlock-code" placeholder="输入 6 位图谱解锁码" class="w-full bg-[#0a0a0a] border border-gray-800 text-[#c5a059] text-center py-4 rounded-sm outline-none focus:border-[#c5a059] transition-colors tracking-[0.3em] placeholder-gray-700 font-mono text-lg">
                </div>
                <p id="error-msg" class="text-red-900 text-[10px] tracking-widest mb-4 hidden">✕ 识别失败，该解锁码不存在或已失效</p>

                <button onclick="verifyCode()" id="verify-btn" class="w-full bg-[#111] border border-[#c5a059] text-[#c5a059] font-medium py-4 rounded-sm tracking-widest hover:bg-[#c5a059] hover:text-black transition-all active:scale-95 flex justify-center items-center text-sm">
                    <span>验证并呈现档案</span>
                </button>
            </div>
        </div>

        <div id="view-result" class="flex-1 flex flex-col p-0 hidden bg-[#050505]">
            <div id="poster-area" class="bg-[#080808] p-8 flex-1 flex flex-col items-center text-center relative border-b border-gray-800 bg-grid">
                
                <div class="w-full flex justify-center items-end mb-8 border-b border-gray-800 pb-4">
                    <div class="text-center">
                        <div class="text-gray-600 text-[9px] tracking-[0.3em] uppercase mb-1">Aesthetic Archetype</div>
                        <div class="text-[#c5a059] text-sm font-serif tracking-widest" id="match-score">XXXX</div>
                    </div>
                </div>
                
                <div class="text-gray-500 text-[10px] tracking-[0.4em] mb-4 uppercase">哲学映射坐标</div>
                <div class="text-white font-serif text-3xl tracking-[0.2em] mb-2" id="result-name">获取中...</div>
                <div class="text-[#c5a059] text-[10px] tracking-[0.2em] font-mono mb-8 uppercase" id="result-en">Loading...</div>

                <div id="result-tags" class="flex flex-wrap justify-center gap-3 mb-10 w-full"></div>

                <div class="w-full relative mb-12 flex justify-center items-center h-[240px]">
                    <div class="absolute text-gray-700 text-[8px] tracking-[0.5em] uppercase top-0">Dimensions</div>
                    <canvas id="radar-chart" width="240" height="240"></canvas>
                </div>

                <div class="w-full text-left relative mb-8">
                    <div class="text-[#c5a059] text-[10px] tracking-[0.3em] mb-4 uppercase">/ 意象分析 Portrait /</div>
                    <p class="text-gray-300 text-[13px] leading-[2.2em] font-light text-justify" id="result-portrait"></p>
                </div>
                
                <div class="w-full text-left relative mb-10">
                    <div class="text-[#c5a059] text-[10px] tracking-[0.3em] mb-4 uppercase">/ 深层解读 Deep Interpretation /</div>
                    <p class="text-gray-400 text-[12px] leading-[2.2em] font-light text-justify" id="result-deepDesc"></p>
                </div>

                <div class="w-full text-left relative mt-auto border-t border-gray-800 pt-8 pb-4">
                    <div class="text-gray-600 text-[9px] tracking-[0.3em] mb-5 uppercase">/ 专属精神补剂 /</div>
                    <div class="mb-4">
                        <div class="text-[#c5a059] text-[11px] tracking-widest mb-1 font-serif">书籍推荐</div>
                        <p class="text-gray-400 text-[11px] tracking-wide leading-relaxed" id="rec-book"></p>
                    </div>
                    <div>
                        <div class="text-[#c5a059] text-[11px] tracking-widest mb-1 font-serif">影像坐标</div>
                        <p class="text-gray-400 text-[11px] tracking-wide leading-relaxed" id="rec-movie"></p>
                    </div>
                </div>
                
                <div class="mt-8 pt-6 flex items-center justify-between w-full border-t border-gray-900">
                    <div class="text-left">
                        <div class="text-white text-lg font-serif tracking-widest mb-1">E | M</div>
                        <p class="text-[8px] text-gray-600 tracking-[0.3em] uppercase">ExisMirror Laboratory</p>
                    </div>
                    <div class="w-12 h-12 border border-gray-800 p-1 flex items-center justify-center bg-[#050505]">
                        <div class="w-full h-full bg-gray-900 flex items-center justify-center text-[7px] text-gray-600 tracking-widest">SCAN</div>
                    </div>
                </div>
            </div>

            <div class="p-6">
                <button id="save-btn" onclick="generatePoster()" class="w-full bg-[#111] border border-gray-800 text-gray-300 font-light py-4 rounded-sm hover:border-[#c5a059] hover:text-[#c5a059] transition-all flex justify-center items-center tracking-[0.2em] text-sm">
                    <span>封装并保存专属档案</span>
                </button>
                <p id="save-tip" class="text-center text-xs text-[#c5a059] mt-4 tracking-widest hidden">档案已生成，请长按上方图片保存</p>
            </div>
        </div>
    </div>

    <script>
        // --- 核心升级：20道潜意识视觉投射测试题 ---
        const questions = [
            // E/I 能量向度 (1-5)
            { title: "如果你的潜意识具象化为一个房间，当你推开门，你希望看到的是：", options: [ { text: "一场永不落幕的地下狂欢，重金属与炽热的灯光交织。", type: "E" }, { text: "一个巨大的环形剧场，你在舞台中央发表演讲，回音激荡。", type: "E" }, { text: "一间只有一束冷光打在几何大理石上的绝对密室。", type: "I" }, { text: "一片沉入海底的图书馆，水草在古老的书架间无声摇曳。", type: "I" } ] },
            { title: "当你凝视一面巨大的黑曜石镜子，镜子里的倒影突然开始异变，它变成了：", options: [ { text: "千千万万个不同面孔的人，他们同时向你伸出手。", type: "E" }, { text: "熊熊燃烧的烈火，似乎要将整个空间吞噬并重塑。", type: "E" }, { text: "渐渐透明的虚影，直到你彻底融入背后的无尽黑暗。", type: "I" }, { text: "一只巨大的、冷酷的眼睛，正在绝对静默中反向审视着你。", type: "I" } ] },
            { title: "想象你被迫要在以下场景中度过漫长的一年，你会选择：", options: [ { text: "穿梭于赛博朋克的霓虹城市，与形形色色的边缘人交易情报。", type: "E" }, { text: "带领一支探险队，在危机四伏的丛林中开辟新航线。", type: "E" }, { text: "独自驻守在远离地球的深空观测站，每天只有星辰与仪器的滴答声。", type: "I" }, { text: "隐居在终年大雪封山的古老修道院，每天抄写无人能懂的经文。", type: "I" } ] },
            { title: "你踏入一家古老的剧院，此时舞台大幕缓缓拉开，你最期待的剧目是：", options: [ { text: "一场由千万名观众共同参与、改变结局的互动狂欢剧。", type: "E" }, { text: "一场演员们用极其激烈的情感碰撞、互相撕裂的悲剧。", type: "E" }, { text: "一出全程只有一名演员在舞台中央低语的独角戏。", type: "I" }, { text: "舞台上空无一人，只有光影在交替变幻，无声诉说时间流逝。", type: "I" } ] },
            { title: "在一座悬浮于宇宙深处的空间站里，你拥有一个全息投影仪，你会用它投射出：", options: [ { text: "地球上最繁华的十字路口，车水马龙，人声鼎沸。", type: "E" }, { text: "一场你曾经参与过的、最热烈奔放的篝火晚会。", type: "E" }, { text: "一个绝对封闭、没有任何门窗的纯白立方体。", type: "I" }, { text: "一片无边无际、连星光都没有的深邃虚空。", type: "I" } ] },
            
            // S/N 感知向度 (6-10)
            { title: "在一片荒芜的沙漠中，你捡到一块奇特的碎片。它的特别之处在于：", options: [ { text: "材质极其罕见，边缘锋利，能在玻璃上轻易划出完美的刻痕。", type: "S" }, { text: "表面布满了极其精密的齿轮，咬合的方式遵循着极致的物理对称。", type: "S" }, { text: "握住它时，你的脑海中会闪现出古代城池崩塌的宏大幻象。", type: "N" }, { text: "没有固定的形态，像一团液态金属，随时映射你内心的情绪流转。", type: "N" } ] },
            { title: "昨天夜里你做了一个异常清晰的梦，梦的核心画面是：", options: [ { text: "你在极其逼真地修理一台结构复杂的机械，机油和金属触感历历在目。", type: "S" }, { text: "你沿着一条崎岖的山路一直走，能真实感受到脚下碎石的每一次硌脚。", type: "S" }, { text: "天空中出现重叠的月亮，引力反转，城市像失重的碎片般漂浮。", type: "N" }, { text: "你遇见了一个没有五官的引路人，他用不属于人类的语言向你传达启示。", type: "N" } ] },
            { title: "你走进一片迷雾森林，面前出现了两条路。引导你做出选择的线索是：", options: [ { text: "泥土上新鲜的脚印和折断的树枝，暗示这里刚刚有大型生物经过。", type: "S" }, { text: "树干上留下的规律性刻痕，像是一种生存标记或方向指引。", type: "S" }, { text: "某条小径深处传来的一种莫名的、跨越时空的宿命般召唤感。", type: "N" }, { text: "直觉告诉你，左边的路代表“毁灭循环”，右边代表“未知剥离”。", type: "N" } ] },
            { title: "你在古董店发现一块没有指针的怀表，把它握在手里，你的第一反应是：", options: [ { text: "感受它金属外壳的冰冷触感和雕花的磨损程度。", type: "S" }, { text: "猜测它内部的发条结构，试图找到它停止走动的物理原因。", type: "S" }, { text: "想象它曾见证过哪些人波澜壮阔或隐秘的一生。", type: "N" }, { text: "觉得它是一个隐喻，暗示着在这个空间里时间已经彻底死亡。", type: "N" } ] },
            { title: "当你面对一幅完全由杂乱色彩泼墨而成的巨幅抽象画时，你倾向于认为：", options: [ { text: "这只是不同化学颜料混合、堆叠后产生的视觉物理现象。", type: "S" }, { text: "作者在作画时的笔触力度和色彩配比具有某种特定的规律。", type: "S" }, { text: "颜色背后隐藏着某种庞大而悲伤的潜意识洪流。", type: "N" }, { text: "这是对整个宇宙混沌状态的一次粗糙但精准的模拟。", type: "N" } ] },

            // T/F 裁决向度 (11-15)
            { title: "假设你拥有了重塑世界规则的权力，你构建的新世界图景更像：", options: [ { text: "一个由绝对理性和因果律统治的晶体都市，没有情感损耗，极其高效。", type: "T" }, { text: "一台庞大而冷酷的运算矩阵，所有的错误和混沌都会被程序自动修正。", type: "T" }, { text: "一个充满诗意和痛苦的荒原，人们为了信仰和爱恨可以毫无保留地燃烧生命。", type: "F" }, { text: "一座永远被温柔极光笼罩的伊甸园，每个人都能感知到灵魂的共振。", type: "F" } ] },
            { title: "面对不可阻挡的世界末日，在最后一小时里，你会看到自己：", options: [ { text: "坐在控制台前，冷静地记录下毁灭的过程和各项数据，直至屏幕黑掉。", type: "T" }, { text: "用尽最后的算力，将人类文明的核心代码发射向深空，保留最后火种。", type: "T" }, { text: "紧紧拥抱你最在乎的人，在巨大的轰鸣声中感受生命最后一次跳动的温度。", type: "F" }, { text: "独自一人走向最高的山峰，面对着滔天的火海，流下一滴悲壮而释然的眼泪。", type: "F" } ] },
            { title: "你发现了一台可以提取人类记忆的机器。你最想提取并保存的是：", options: [ { text: "那些顿悟了宇宙物理法则、解开世纪难题时的绝对清醒瞬间。", type: "T" }, { text: "战胜宿敌、掌控全局时那种绝对冷静的、如同上帝视角般的博弈记忆。", type: "T" }, { text: "某次刻骨铭心的离别，那种让灵魂彻底撕裂的极致痛苦与凄美。", type: "F" }, { text: "那些在绝望中依然选择互相救赎、燃烧出人性微光的纯粹时刻。", type: "F" } ] },
            { title: "在一艘即将沉没的救生艇上，必须抛弃一件物品，你会毫不犹豫地扔掉：", options: [ { text: "一本记载着无用诗歌和随笔的精美手稿。", type: "T" }, { text: "某个充满回忆但缺乏实际生存功能的纪念物。", type: "T" }, { text: "一台精准计算沉没概率，但持续发出刺耳警报的冰冷仪器。", type: "F" }, { text: "一本写满极度冷酷、弱肉强食生存法则的操作手册。", type: "F" } ] },
            { title: "如果有一个按钮，按下后可以消除全人类的痛苦，但代价是消除所有的爱，你会：", options: [ { text: "按下，绝对的平静和秩序优于混乱的情感波动。", type: "T" }, { text: "按下，因为从宏观演算来看，零损耗的社会运转效率更高。", type: "T" }, { text: "拒绝，没有爱的世界，即使再完美也只是一座巨大的坟墓。", type: "F" }, { text: "拒绝，宁愿在痛苦中挣扎，也要保留灵魂震颤的权利。", type: "F" } ] },

            // J/P 秩序向度 (16-20)
            { title: "给你一张巨大的空白画布和颜料，你的创作过程更像：", options: [ { text: "先用铅笔画出极其精确的黄金分割线和透视网格，然后严丝合缝地上色。", type: "J" }, { text: "脑海中已经有了明确的最终画面，为了达到那个效果机械般地修改一千次。", type: "J" }, { text: "直接把整桶红色颜料泼上去，让重力决定线条的走向，在混沌中寻找意义。", type: "P" }, { text: "没有任何目的，只是感受画笔在粗糙帆布上摩擦的阻力，画到哪里算哪里。", type: "P" } ] },
            { title: "你即将开启一场没有归期的长途放逐，你的行囊里装的是：", options: [ { text: "极其精密的生存指南、校准过的指南针和每天的能量摄入分配表。", type: "J" }, { text: "一本写满了目的地经纬度坐标、历史资料和详尽攻略的手册。", type: "J" }, { text: "只有一张模糊的藏宝图残卷，和一颗随时准备迎接任何意外的心。", type: "P" }, { text: "甚至连行囊都不带，随便跳上一辆不知开往哪里的列车，消失在夜色中。", type: "P" } ] },
            { title: "一个神秘人递给你一个黑色的金属盒子。对于如何打开它，你的态度是：", options: [ { text: "寻找盒子表面的锁孔或密码盘，用逻辑推演尝试破解它的机关。", type: "J" }, { text: "把它放在桌面上，设定一个绝对安全的实验流程，使用工具一层层将其拆解。", type: "J" }, { text: "拿在手里随意把玩，或许在不经意间触碰了某个暗扣，它就自己弹开了。", type: "P" }, { text: "如果一时打不开就算了，把它当成一个带有神秘悬念的哑铃，每天举两下。", type: "P" } ] },
            { title: "面对一座庞大而复杂的迷宫，你被要求在日落前走出，你的策略是：", options: [ { text: "拿出一张纸，在每走一步时精确绘制地形坐标图，绝不走回头路。", type: "J" }, { text: "严格遵循“永远贴着右墙走”的绝对法则，用机械式的纪律对抗未知。", type: "J" }, { text: "跟着直觉和风的流动随意乱走，也许迷失本身就是一种答案。", type: "P" }, { text: "走到哪里算哪里，如果出不去，就在迷宫中心睡一觉。", type: "P" } ] },
            { title: "你收到一封没有署名的信，信封上写着“你的未来”，你会：", options: [ { text: "立刻拆开，仔细阅读每一个字，以便提前做好万全的应对计划。", type: "J" }, { text: "用扫描仪将其数字化并分类归档，纳入自己的风险控制体系中。", type: "J" }, { text: "随手扔进抽屉里，剧透的未来会毁掉所有生活里的盲盒惊喜。", type: "P" }, { text: "用火柴把它烧掉，看着灰烬飞散，证明未来只存在于当下的混沌中。", type: "P" } ] }
        ];

        // --- 16型哲学家字典 (雷达图维度顺序: [绝对理性, 极致共情, 内在秩序, 精神叛逆, 灵魂深度]) ---
        const resultsDict = {
            "INTJ": { 
                name: "尼采", en: "Friedrich Nietzsche", tags: ["超人哲学", "权力意志"], radar: [90, 15, 60, 95, 85],
                portrait: "你的精神图景是一座矗立在暴风雨中的黑曜石高塔。你拒绝世俗的温吞与妥协，灵魂深处燃烧着冰冷的权力意志。你的存在本身，就是一场对平庸的宣战。",
                deepDesc: "作为一个极端的完美主义者和秩序破坏者，你深知“上帝已死”。因此，你试图用绝对的意志力去砸碎旧有的道德枷锁，建立属于自己的精神帝国。“其实人跟树是一样的，越是向往高处的阳光，它的根就越要伸向黑暗的地底。” 你在孤独中凝视深渊，不仅为了看清黑暗，更为了超越它。",
                recs: { book: "《查拉图斯特拉如是说》— 凝视深渊的超人宣言与权力意志。", movie: "《都灵之马》— 剥离一切意义后，纯粹的虚无与存在。" }
            },
            "INTP": { 
                name: "维特根斯坦", en: "Ludwig Wittgenstein", tags: ["语言游戏", "逻辑边界"], radar: [95, 20, 70, 60, 90],
                portrait: "你的精神图景是一个精密咬合却无限循环的几何迷宫。你疏离于人群，用冷峻的目光审视着世界运转的底层齿轮。",
                deepDesc: "你活在自己庞大的逻辑体系中，热衷于拆解语言和思维的边界。“凡是不能说的事情，就应该保持沉默。” 你追求绝对的真理，却常对现实的荒谬与人类的愚蠢感到无奈。你是一个在逻辑荒原上孤独跋涉的苦行僧。",
                recs: { book: "《逻辑哲学论》— 用绝对理性的手术刀解剖语言与世界的边界。", movie: "《黑客帝国》— 质疑现实程序的终极逻辑实验。" }
            },
            "ENTJ": { 
                name: "霍布斯", en: "Thomas Hobbes", tags: ["利维坦", "现实法则"], radar: [85, 20, 90, 70, 60],
                portrait: "你的精神图景是一艘在狂风巨浪中平稳航行的钢铁巨舰。你藐视混沌，天生渴望用铁腕手段去征服并建立规则。",
                deepDesc: "你拒绝天真的幻想，深谙现实世界的权力博弈与丛林法则。在你眼中，目的永远重于手段。你试图在“所有人对所有人的战争”中，构建绝对的秩序与利维坦。你是天生的统治者，不相信眼泪，只相信实力。",
                recs: { book: "《君主论》— 剥离道德伪装，直视权力的冷酷法则。", movie: "《血色将至》— 资本与秩序建立过程中的野蛮搏杀。" }
            },
            "ENTP": { 
                name: "苏格拉底", en: "Socrates", tags: ["精神牛虻", "无休止质问"], radar: [80, 40, 40, 95, 85],
                portrait: "你的精神图景是一束刺破迷雾的锐利探照灯。你是个迷人的破坏者，随时准备用尖锐的质问去撕裂一切理所当然的表象。",
                deepDesc: "“我唯一知道的，就是我一无所知。” 你的存在就是一场永无止境的辩证法。真理对你而言不在于终点的结论，而在于推翻既定认知的爽快过程。你热衷于在思想的交锋中拆解伪善，是这个世界上不可或缺的清醒剂。",
                recs: { book: "《斐多篇》— 面向死亡时的绝对清醒与灵魂拷问。", movie: "《十二怒汉》— 用质疑的利刃划破偏见的铁幕。" }
            },
            "INFJ": { 
                name: "叔本华", en: "Arthur Schopenhauer", tags: ["悲观主义", "深刻孤独"], radar: [60, 85, 70, 50, 95],
                portrait: "你的精神图景是一片绝对静谧的黑色深海。你有着极具压迫感的洞察力，能轻易穿透表象，看见人们试图掩藏的欲望与千疮百孔。",
                deepDesc: "“生命是一团欲望，不满足便痛苦，满足便无聊。” 你带着一种先天的悲剧色彩，渴望纯粹的灵魂连接，却又看透了人性的虚无，最终选择退回孤独的堡垒。你在冷眼旁观中，获得了某种凄美的精神自由。",
                recs: { book: "《作为意志和表象的世界》— 直视痛苦，洞悉生命荒芜的本质。", movie: "《忧郁症》— 在不可避免的毁灭前，展现极致的脆弱与绝望美学。" }
            },
            "INFP": { 
                name: "加缪", en: "Albert Camus", tags: ["荒诞主义", "浪漫反抗"], radar: [50, 90, 40, 85, 90],
                portrait: "你的精神图景是一场在荒原上无声燃烧的篝火。你外表内敛，内心却涌动着不可救药的浪漫与对抗无意义的激情。",
                deepDesc: "你深知世界的荒谬，但依然选择带着理想主义的悲壮去生活。“在隆冬，我终于知道，我身上有一个不可战胜的夏天。” 你不会向虚无屈服，而是选择像西西弗斯那样在推石头的无望重复中寻找实感。你内心的柔软与坚韧，是你唯一的武器。",
                recs: { book: "《西西弗神话》— 面对不可战胜的荒诞，依然选择将石头推向山顶。", movie: "《第七封印》— 与死神对弈，寻找信仰与存在的微光。" }
            },
            "ENFJ": { 
                name: "萨特", en: "Jean-Paul Sartre", tags: ["绝对自由", "他者即地狱"], radar: [60, 85, 50, 80, 80],
                portrait: "你的精神图景是一束在暗夜里指引方向的炽热火炬。你拒绝任何既定的标签，用极强的感染力去燃烧自己、照亮他人。",
                deepDesc: "“存在先于本质，人注定是自由的。” 你相信人必须通过行动去创造意义。你试图唤醒周围人被麻痹的意志，哪怕这自由伴随着巨大的责任与痛苦。你是一个天生的精神领袖，用理想主义的光芒对抗着世界的冷漠。",
                recs: { book: "《存在与虚无》— 剖析自由的重担与自欺的泥沼。", movie: "《搏击俱乐部》— 砸碎物质枷锁，唤醒麻木灵魂的暴力狂欢。" }
            },
            "ENFP": { 
                name: "克尔凯郭尔", en: "Søren Kierkegaard", tags: ["信仰之跃", "存在激情"], radar: [40, 95, 30, 90, 85],
                portrait: "你的精神图景是一场在悬崖边缘狂舞的暴风雪。你拒绝被机械的理性定义，永远在追寻极致的情感与无限的可能性。",
                deepDesc: "“生命不是一个需要解决的问题，而是一个需要体验的现实。” 你听从内心的激情，面对人生的不确定性，你随时准备完成一次跨越理性的“信仰之跃”。即使前方是深渊，你也认为值得为了纯粹的体验而纵身一跃。",
                recs: { book: "《恐惧与战栗》— 在绝望边缘做出违背理性的终极选择。", movie: "《死亡诗社》— 撕碎僵化的教条，燃烧生命的诗意激情。" }
            },
            "ISTJ": { 
                name: "马可·奥勒留", en: "Marcus Aurelius", tags: ["斯多葛学派", "内在堡垒"], radar: [85, 40, 95, 20, 70],
                portrait: "你的精神图景是一座抵御时间风化的古罗马大理石要塞。你冷峻、克制，在失控的世界里恪守着钢铁般的秩序。",
                deepDesc: "面对外界的喧嚣与无常，你选择向内收摄。“你不仅有权屏蔽外界的喧嚣，更有能力在内心重建绝对的秩序。” 极致的自律和责任感，构筑了你不可摧毁的精神防线。你是混乱时代中，最坚固的锚。",
                recs: { book: "《沉思录》— 乱世风暴眼中的绝对克制与自我修行。", movie: "《银翼杀手2049》— 在赛博废墟中恪守孤独的责任与真实。" }
            },
            "ISFJ": { 
                name: "康德", en: "Immanuel Kant", tags: ["绝对命令", "道德律"], radar: [70, 70, 90, 10, 70],
                portrait: "你的精神图景是一片在极夜中恒久闪烁的静谧星空。你温和而坚韧，是这个混乱世界中隐秘而不可或缺的支撑锚点。",
                deepDesc: "“世界上唯有两样东西能让我们的内心受到深深的震撼，一是我们头顶的星空，一是我们内心的道德律。” 你内敛、坚韧，对规则和底线有着近乎信仰般的坚守。你用耐心梳理着日常的混沌，相信最微小的责任里也藏着支撑世界运转的伟大因果。",
                recs: { book: "《纯粹理性批判》— 厘清认知边界，重建精神世界的庄严法度。", movie: "《窃听风暴》— 在极权暗夜里，人性道德底线的无声觉醒。" }
            },
            "ESTJ": { 
                name: "亚里士多德", en: "Aristotle", tags: ["现实主义", "第一性原理"], radar: [90, 30, 95, 20, 60],
                portrait: "你的精神图景是一座精密运作、条理分明的巨大时钟。你鄙视空洞的幻想，是脚踏实地的构建者与规则的捍卫者。",
                deepDesc: "“吾爱吾师，吾更爱真理。” 你习惯将复杂的世界拆解为可执行的步骤。你坚信，通过清晰的分类法则和不懈的努力，就能完美掌控现实的物理法则。你没有任何精神内耗，只关心如何将图纸变为现实的丰碑。",
                recs: { book: "《尼各马可伦理学》— 在现实的尘埃中构筑理性的中庸之道。", movie: "《华尔街之狼》— 剥离虚伪的温情，直击欲望与资本的运转逻辑。" }
            },
            "ESFJ": { 
                name: "休谟", en: "David Hume", tags: ["经验主义", "羁绊缔造者"], radar: [60, 85, 80, 20, 50],
                portrait: "你的精神图景是一张交织着温度与光芒的巨大网络。你深知人类社会的本质是连接，你是无常生活中最可靠的羁绊缔造者。",
                deepDesc: "“理性是、并且也应该是情感的奴隶。” 相较于冷冰冰的逻辑，你更愿意相信温度与经验。你用极强的共情力和行动力，为周围的人建立起坚实的避风港。在虚无面前，你用真切的人际温暖构筑了存在的意义。",
                recs: { book: "《人性论》— 承认理性的局限，拥抱感知与经验的温度。", movie: "《触不可及》— 跨越阶级与苦难，人与人之间最纯粹的羁绊。" }
            },
            "ISTP": { 
                name: "第欧根尼", en: "Diogenes", tags: ["犬儒主义", "极简行者"], radar: [80, 20, 60, 95, 60],
                portrait: "你的精神图景是一把被随意丢弃在荒野中的锋利匕首。你极其反感社会的虚伪包装，崇尚最本真、最粗粝的生存状态。",
                deepDesc: "“请不要挡住我的阳光。” 你用一种冷漠的犬儒主义嘲讽世俗。你不关心宏大的意义，但对世界真实的物理运转规律有着极其敏锐、刀剑般的直觉。你是一个永远在路上的独行侠，只向真实的触感低头。",
                recs: { book: "《瓦尔登湖》— 剥离现代文明的繁复，回归极致极简的粗粝生存。", movie: "《荒野生存》— 决绝地逃离社会机器，在荒野中寻找终极自由。" }
            },
            "ISFP": { 
                name: "卢梭", en: "Jean-Jacques Rousseau", tags: ["自然主义", "浪漫觉醒"], radar: [30, 85, 40, 80, 95],
                portrait: "你的精神图景是一片未被文明涉足的原始森林。你对现代社会的异化感到本能的抗拒，渴望回归最纯粹、最本真的生命体验。",
                deepDesc: "“人生而自由，却无往不在枷锁之中。” 你拒绝被冰冷的工业法则和虚伪的社交礼仪规训。你有着极其敏锐的感官与审美直觉，比起严密的逻辑，你更愿意相信自己内心的悲悯与真实的悸动。你是一个在钢铁水泥中寻找精神原乡的漫步者。",
                recs: { book: "《孤独漫步者的遐想》— 剥离社会面具，在自然中找回灵魂的绝对宁静。", movie: "《小森林》— 逃离喧嚣系统，用双手和感官重塑真实的生活质感。" }
            },
            "ESTP": { 
                name: "马基雅维利", en: "Machiavelli", tags: ["实用主义", "绝对行动力"], radar: [85, 30, 60, 80, 40],
                portrait: "你的精神图景是一头在夜色中悄然逼近猎物的矫健孤狼。你有着极其敏锐的嗅觉和适应力，是天生的现实主义掠食者。",
                deepDesc: "“目的总是证明手段的正确。” 面对危机，你从不陷入精神内耗，而是迅速计算出最优解。你用狮子般的勇猛和狐狸般的狡黠，在现实丛林中游刃有余。对你来说，生存的法则永远高于空洞的道德说教。",
                recs: { book: "《战争论》— 抛弃道德束缚，聚焦现实冲突与利益最大化。", movie: "《疯狂的麦克斯4》— 废土世界中不废话的狂飙突进与暴力生存。" }
            },
            "ESFP": { 
                name: "伊壁鸠鲁", en: "Epicurus", tags: ["享乐主义", "静态快乐"], radar: [40, 70, 40, 85, 60],
                portrait: "你的精神图景是一场在末日降临前夜纵情声色的盛大宴会。你深知生命的短暂，因此拒绝为遥远的未来感到焦虑。",
                deepDesc: "“死对于我们无干。因为凡是消散了的都没有感觉。” 你选择沉浸于当下的每一秒感官体验，规避痛苦，追求静态的快乐。你用最热烈的姿态拥抱现在，把每一天都当作最后的狂欢。你的存在是对虚无最绝妙的反击。",
                recs: { book: "《不可承受的生命之轻》— 在意义的消解中，体验存在的失重感与感官狂欢。", movie: "《醉乡民谣》— 接受人生的平庸与失败，在循环的日常中寻找音乐的慰藉。" }
            }
        };

        let currentStep = 0;
        let mbtiScores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
        let chartInstance = null;

        function switchView(hideId, showId) {
            document.getElementById(hideId).classList.add('hidden');
            document.getElementById(showId).classList.remove('hidden');
        }

        function startQuiz() {
            switchView('view-home', 'view-quiz');
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentStep];
            document.getElementById('progress-text').innerText = `${currentStep + 1}/${questions.length}`;
            
            const titleEl = document.getElementById('question-title');
            const optionsContainer = document.getElementById('options-container');
            
            const container = document.getElementById('question-container');
            container.classList.remove('fade-in');
            void container.offsetWidth; 
            container.classList.add('fade-in');

            titleEl.innerText = q.title;
            optionsContainer.innerHTML = '';

            q.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-5 rounded-sm border border-gray-800 bg-[#080808] text-gray-300 hover:bg-[#111] hover:border-[#c5a059] hover:text-white transition-all font-light text-sm tracking-wide leading-relaxed shadow-sm";
                btn.innerText = opt.text;
                btn.onclick = () => selectOption(opt.type);
                optionsContainer.appendChild(btn);
            });
        }

        function selectOption(type) {
            mbtiScores[type]++;
            if (currentStep < questions.length - 1) {
                currentStep++;
                renderQuestion();
            } else {
                startLoadingAnimation();
            }
        }

        function startLoadingAnimation() {
            switchView('view-quiz', 'view-loading');
            
            const textEl = document.getElementById('loading-text');
            const texts = ["提取潜意识投影...", "锚定哲学坐标...", "封装精神档案..."];
            let i = 0;
            
            const interval = setInterval(() => {
                if(i < texts.length) {
                    textEl.innerText = texts[i];
                    i++;
                }
            }, 800);

            setTimeout(() => {
                clearInterval(interval);
                switchView('view-loading', 'view-paywall');
            }, 2500);
        }

        function verifyCode() {
            const codeInput = document.getElementById('unlock-code').value;
            const btn = document.getElementById('verify-btn');
            const errorMsg = document.getElementById('error-msg');
            
            if (codeInput && !isNaN(codeInput) && parseInt(codeInput) % 97 === 13) {
                errorMsg.classList.add('hidden');
                btn.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-[#c5a059] inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> 档案解密中...`;
                
                setTimeout(() => {
                    let finalType = "";
                    finalType += (mbtiScores.E > mbtiScores.I) ? "E" : "I";
                    finalType += (mbtiScores.S > mbtiScores.N) ? "S" : "N";
                    finalType += (mbtiScores.T > mbtiScores.F) ? "T" : "F";
                    finalType += (mbtiScores.J > mbtiScores.P) ? "J" : "P";
                    
                    prepareResultData(finalType);
                    switchView('view-paywall', 'view-result');
                }, 1000);
            } else {
                errorMsg.classList.remove('hidden');
                const inputEl = document.getElementById('unlock-code');
                inputEl.classList.add('border-red-900');
                setTimeout(() => inputEl.classList.remove('border-red-900'), 500);
            }
        }

        function prepareResultData(mbtiType) {
            const result = resultsDict[mbtiType] || resultsDict["INTJ"];

            document.getElementById('match-score').innerText = mbtiType;
            document.getElementById('result-name').innerText = result.name;
            document.getElementById('result-en').innerText = result.en;
            
            document.getElementById('result-portrait').innerText = result.portrait;
            document.getElementById('result-deepDesc').innerText = result.deepDesc;
            
            document.getElementById('rec-book').innerText = result.recs.book;
            document.getElementById('rec-movie').innerText = result.recs.movie;

            const tagsContainer = document.getElementById('result-tags');
            tagsContainer.innerHTML = '';
            result.tags.forEach(tag => {
                tagsContainer.innerHTML += `<span class="px-4 py-1.5 border border-[#c5a059]/30 text-[#c5a059] text-[10px] tracking-widest bg-[#c5a059]/10">${tag}</span>`;
            });

            renderRadarChart(result.radar);
        }

        function renderRadarChart(dataArr) {
            const ctx = document.getElementById('radar-chart').getContext('2d');
            if(chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['绝对理性', '极致共情', '内在秩序', '精神叛逆', '灵魂深度'],
                    datasets: [{
                        data: dataArr,
                        backgroundColor: 'rgba(197, 160, 89, 0.15)',
                        borderColor: 'rgba(197, 160, 89, 0.8)',
                        borderWidth: 1,
                        pointBackgroundColor: '#c5a059',
                        pointBorderColor: '#000',
                        pointRadius: 2,
                        pointHoverRadius: 4
                    }]
                },
                options: {
                    animation: false, 
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.08)' },
                            grid: { color: 'rgba(255, 255, 255, 0.08)' },
                            pointLabels: { color: '#aaa', font: { size: 10, family: 'Courier New, monospace', weight: '400' } },
                            ticks: { display: false, max: 100, min: 0 }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function generatePoster() {
            const btn = document.getElementById('save-btn');
            btn.innerHTML = `档案封装中...`;
            const target = document.getElementById('poster-area');
            
            html2canvas(target, { scale: 2, useCORS: true, backgroundColor: "#050505" }).then(canvas => {
                const img = document.createElement('img');
                img.src = canvas.toDataURL('image/png');
                img.className = "w-full h-auto rounded-sm shadow-2xl border border-gray-800";
                target.parentNode.insertBefore(img, target);
                target.style.display = 'none';
                btn.style.display = 'none';
                document.getElementById('save-tip').classList.remove('hidden');
            });
        }
    </script>
</body>
</html>